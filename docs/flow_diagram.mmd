%% AI Orchestrator Studio - Flow Diagram (Mermaid)
%% Save as .mmd and render with Mermaid tools or VS Code Mermaid extension

graph TD
  %% UI Layer
  U[User Prompt] -->|HTTP/REST| UI[Frontend: ChatStudio]
  UI -->|POST /api/chat/ui/send (SSE)| BE[Backend: FastAPI]
  UI -->|GET /api/chat/ui/models| BE
  UI -->|GET /api/chat/ui/profiles| BE
  UI -->|GET /api/chat/ui/conversations| BE

  %% Orchestration Graph
  BE --> IR[Intent Router]
  IR -->|route| PL[Planner]
  PL -->|plan| LA[LLM Agent]
  LA -->|tool_call| TE[Tool Executor]
  TE -->|fetch_data| GR[Grounding]
  GR -->|context| LA
  LA -->|store| MS[Memory Store]
  MS -->|log| AU[Audit]
  AU --> END[End]

  %% Direct LLM path
  IR -->|direct_llm| LA

  %% External Agent path
  LA --> EA[External Agent]
  EA --> LA

  %% Data Sources and Tools
  TE -->|HTTP, Search, Code| DS[(Datasources)]
  GR --> DS

  %% Response back to UI
  END -->|SendMessageResponse + metadata| UI
